diff --git a/docs/sdy_dialect.md b/docs/sdy_dialect.md
index ec9c696..767786b 100755
--- a/docs/sdy_dialect.md
+++ b/docs/sdy_dialect.md
@@ -279,14 +279,12 @@ sdy.mesh @mesh = <["a"=2, "b"=2, "c"=4, "d"=2, "e"=2, "f"=2]>
 
 **Constraints:**
 - Must satisfy the constraints listed in `Sdy_CollectiveOpInterface`.
-- If input and output sharding have different meshes, then those meshes must
-  have exactly the same axes and different order of device ids.
 - For each dimension, the product of sharding axis sizes in `out_sharding`
   must match that of the corresponding operand dimension sharding.
 
 Traits: `SameOperandsAndResultType`
 
-Interfaces: `CollectiveOpInterface`, `InferTypeOpInterface`
+Interfaces: `InferTypeOpInterface`, `Sdy_CollectiveOpInterface`
 
 #### Attributes:
 
diff --git a/docs/sdy_op_interfaces.md b/docs/sdy_op_interfaces.md
index 8dc6049..e0edb0d 100755
--- a/docs/sdy_op_interfaces.md
+++ b/docs/sdy_op_interfaces.md
@@ -10,8 +10,7 @@ outSharding attribute.
 **Constraints:**
 - Operand must have a sharding.
 - `out_sharding` is valid w.r.t the corresponding type.
-- Operand and result sharding must have the same mesh if
-  `allowDifferentMeshes()` returns false.
+- MeshAttr of result and operand is the same.
 - Same rank for the operand and result sharding.
 
 ### Methods:
@@ -56,17 +55,6 @@ Get the type of the collective op result.
 
 NOTE: This method *must* be implemented by the user.
 
-#### `allowDifferentMeshes`
-
-```c++
-bool allowDifferentMeshes();
-```
-
-Indicated whether the collective op allows the input and output sharding
-to have different meshes.
-
-NOTE: This method *must* be implemented by the user.
-
 ## ShardableDataFlowOpInterface (`Sdy_ShardableDataFlowOpInterface`)
 
 An op interface that allows shardy to propagate shardings through data flow
diff --git a/third_party/llvm/generated.patch b/third_party/llvm/generated.patch
index 8617d02..509398d 100644
--- a/third_party/llvm/generated.patch
+++ b/third_party/llvm/generated.patch
@@ -1,841 +1 @@
 Auto generated patch. Do not edit or delete it, even if empty.
-diff -ruN --strip-trailing-cr a/mlir/include/mlir/Dialect/Tosa/IR/TosaComplianceData.h b/mlir/include/mlir/Dialect/Tosa/IR/TosaComplianceData.h
---- a/mlir/include/mlir/Dialect/Tosa/IR/TosaComplianceData.h
-+++ b/mlir/include/mlir/Dialect/Tosa/IR/TosaComplianceData.h
-@@ -1,403 +0,0 @@
--// The profile-based compliance content below is auto-generated by the script
--// `tools/genspec.py` in https://git.mlplatform.org/tosa/specification.git
--profileComplianceMap = {
--    {"tosa.argmax",
--     {{{Profile::pro_int}, {{i8T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, i32T}, {fp32T, i32T}}}}},
--    {"tosa.avg_pool2d",
--     {{{Profile::pro_int}, {{i8T, i32T, i8T}}},
--      {{Profile::pro_fp},
--       {{fp16T, fp16T, fp16T}, {fp16T, fp32T, fp16T}, {fp32T, fp32T, fp32T}}}}},
--    {"tosa.conv2d",
--     {{{Profile::pro_int}, {{i8T, i8T, i32T, i32T, i32T}}},
--      {{Profile::pro_fp},
--       {{fp16T, fp16T, fp16T, fp16T, fp16T},
--        {fp16T, fp16T, fp16T, fp32T, fp16T},
--        {fp32T, fp32T, fp32T, fp32T, fp32T}}}}},
--    {"tosa.conv3d",
--     {{{Profile::pro_int}, {{i8T, i8T, i32T, i32T, i32T}}},
--      {{Profile::pro_fp},
--       {{fp16T, fp16T, fp16T, fp16T, fp16T},
--        {fp16T, fp16T, fp16T, fp32T, fp16T},
--        {fp32T, fp32T, fp32T, fp32T, fp32T}}}}},
--    {"tosa.depthwise_conv2d",
--     {{{Profile::pro_int}, {{i8T, i8T, i32T, i32T, i32T}}},
--      {{Profile::pro_fp},
--       {{fp16T, fp16T, fp16T, fp16T, fp16T},
--        {fp16T, fp16T, fp16T, fp32T, fp16T},
--        {fp32T, fp32T, fp32T, fp32T, fp32T}}}}},
--    {"tosa.fully_connected",
--     {{{Profile::pro_int}, {{i8T, i8T, i32T, i32T}}},
--      {{Profile::pro_fp},
--       {{fp16T, fp16T, fp16T, fp16T},
--        {fp16T, fp16T, fp32T, fp32T},
--        {fp32T, fp32T, fp32T, fp32T}}}}},
--    {"tosa.matmul",
--     {{{Profile::pro_int}, {{i8T, i8T, i32T}}},
--      {{Profile::pro_fp},
--       {{fp16T, fp16T, fp16T}, {fp16T, fp16T, fp32T}, {fp32T, fp32T, fp32T}}}}},
--    {"tosa.max_pool2d",
--     {{{Profile::pro_int}, {{i8T, i8T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.transpose_conv2d",
--     {{{Profile::pro_int}, {{i8T, i8T, i32T, i32T, i32T}}},
--      {{Profile::pro_fp},
--       {{fp16T, fp16T, fp16T, fp16T, fp16T},
--        {fp16T, fp16T, fp16T, fp32T, fp16T},
--        {fp32T, fp32T, fp32T, fp32T, fp32T}}}}},
--    {"tosa.clamp",
--     {{{Profile::pro_int}, {{i8T, i8T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.erf", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.sigmoid", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.tanh", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.add",
--     {{{Profile::pro_int, Profile::pro_fp}, {{i32T, i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
--    {"tosa.arithmetic_right_shift",
--     {{{Profile::pro_int},
--       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}}}},
--    {"tosa.bitwise_and",
--     {{{Profile::pro_int},
--       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}}}},
--    {"tosa.bitwise_or",
--     {{{Profile::pro_int},
--       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}}}},
--    {"tosa.bitwise_xor",
--     {{{Profile::pro_int},
--       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}}}},
--    {"tosa.intdiv",
--     {{{Profile::pro_int, Profile::pro_fp}, {{i32T, i32T, i32T}}}}},
--    {"tosa.logical_and",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT, boolT}}}}},
--    {"tosa.logical_left_shift",
--     {{{Profile::pro_int, Profile::pro_fp},
--       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}}}},
--    {"tosa.logical_right_shift",
--     {{{Profile::pro_int, Profile::pro_fp},
--       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}}}},
--    {"tosa.logical_or",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT, boolT}}}}},
--    {"tosa.logical_xor",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT, boolT}}}}},
--    {"tosa.maximum",
--     {{{Profile::pro_int}, {{i32T, i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
--    {"tosa.minimum",
--     {{{Profile::pro_int}, {{i32T, i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
--    {"tosa.mul",
--     {{{Profile::pro_int}, {{i8T, i8T, i32T}, {i16T, i16T, i32T}}},
--      {{Profile::pro_int, Profile::pro_fp}, {{i32T, i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
--    {"tosa.pow",
--     {{{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
--    {"tosa.sub",
--     {{{Profile::pro_int, Profile::pro_fp}, {{i32T, i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
--    {"tosa.table", {{{Profile::pro_int}, {{i8T, i8T, i8T}}}}},
--    {"tosa.abs",
--     {{{Profile::pro_int}, {{i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.bitwise_not",
--     {{{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}}}},
--    {"tosa.ceil", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.clz", {{{Profile::pro_int}, {{i32T, i32T}}}}},
--    {"tosa.cos", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.exp", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.floor", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.log", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.logical_not",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}}}},
--    {"tosa.negate",
--     {{{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.reciprocal",
--     {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.rsqrt", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.select",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT, boolT}}},
--      {{Profile::pro_int},
--       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
--    {"tosa.sin", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.equal",
--     {{{Profile::pro_int}, {{i32T, i32T, boolT}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T, boolT}, {fp32T, fp32T, boolT}}}}},
--    {"tosa.greater",
--     {{{Profile::pro_int}, {{i32T, i32T, boolT}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T, boolT}, {fp32T, fp32T, boolT}}}}},
--    {"tosa.greater_equal",
--     {{{Profile::pro_int}, {{i32T, i32T, boolT}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T, boolT}, {fp32T, fp32T, boolT}}}}},
--    {"tosa.reduce_all",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}}}},
--    {"tosa.reduce_any",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}}}},
--    {"tosa.reduce_max",
--     {{{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.reduce_min",
--     {{{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.reduce_product",
--     {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.reduce_sum",
--     {{{Profile::pro_int}, {{i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.concat",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}},
--      {{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.pad",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}},
--      {{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.reshape",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}},
--      {{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.reverse",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}},
--      {{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.slice",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}},
--      {{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.tile",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}},
--      {{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.transpose",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}},
--      {{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.gather",
--     {{{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.scatter",
--     {{{Profile::pro_int},
--       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
--    {"tosa.resize",
--     {{{Profile::pro_int}, {{i8T, i32T}, {i8T, i8T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.cast",
--     {{{Profile::pro_int},
--       {{boolT, i8T},
--        {boolT, i16T},
--        {boolT, i32T},
--        {i8T, boolT},
--        {i8T, i16T},
--        {i8T, i32T},
--        {i16T, boolT},
--        {i16T, i8T},
--        {i16T, i32T},
--        {i32T, boolT},
--        {i32T, i8T},
--        {i32T, i16T}}},
--      {{Profile::pro_fp},
--       {{i8T, fp16T},
--        {i8T, fp32T},
--        {i16T, fp16T},
--        {i16T, fp32T},
--        {i32T, fp16T},
--        {i32T, fp32T},
--        {fp16T, i8T},
--        {fp16T, i16T},
--        {fp16T, i32T},
--        {fp16T, fp32T},
--        {fp32T, i8T},
--        {fp32T, i16T},
--        {fp32T, i32T},
--        {fp32T, fp16T}}}}},
--    {"tosa.rescale",
--     {{{Profile::pro_int},
--       {{i8T, i8T},
--        {i8T, i16T},
--        {i8T, i32T},
--        {i16T, i8T},
--        {i16T, i16T},
--        {i16T, i32T},
--        {i32T, i8T},
--        {i32T, i16T},
--        {i32T, i32T}}}}},
--    {"tosa.const",
--     {{{Profile::pro_int}, {{boolT}, {i8T}, {i16T}, {i32T}}},
--      {{Profile::pro_fp}, {{fp16T}, {fp32T}}}}},
--    {"tosa.identity",
--     {{{Profile::pro_int},
--       {{boolT, boolT}, {i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
--      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
--    {"tosa.dim",
--     {{{Profile::pro_int, Profile::pro_fp}, {{boolT}}},
--      {{Profile::pro_int}, {{i8T}, {i16T}, {i32T}}},
--      {{Profile::pro_fp}, {{fp16T}, {fp32T}}}}},
--};
--
--extensionComplianceMap = {
--    {"tosa.argmax",
--     {{{Extension::int16}, {{i16T, i32T}}},
--      {{Extension::fp8e4m3}, {{fp8e4m3T, i32T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, i32T}}},
--      {{Extension::bf16}, {{bf16T, i32T}}}}},
--    {"tosa.avg_pool2d",
--     {{{Extension::int16}, {{i16T, i32T, i16T}}},
--      {{Extension::fp8e4m3}, {{fp8e4m3T, fp16T, fp8e4m3T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp16T, fp8e5m2T}}},
--      {{Extension::bf16}, {{bf16T, fp32T, bf16T}}}}},
--    {"tosa.conv2d",
--     {{{Extension::int4}, {{i8T, i4T, i32T, i32T, i32T}}},
--      {{Extension::int16}, {{i16T, i8T, i48T, i48T, i48T}}},
--      {{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T, fp16T, fp16T, fp16T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T, fp16T, fp16T, fp16T}}},
--      {{Extension::bf16}, {{bf16T, bf16T, bf16T, fp32T, bf16T}}}}},
--    {"tosa.conv3d",
--     {{{Extension::int4}, {{i8T, i4T, i32T, i32T, i32T}}},
--      {{Extension::int16}, {{i16T, i8T, i48T, i48T, i48T}}},
--      {{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T, fp16T, fp16T, fp16T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T, fp16T, fp16T, fp16T}}},
--      {{Extension::bf16}, {{bf16T, bf16T, bf16T, fp32T, bf16T}}}}},
--    {"tosa.depthwise_conv2d",
--     {{{Extension::int4}, {{i8T, i4T, i32T, i32T, i32T}}},
--      {{Extension::int16}, {{i16T, i8T, i48T, i48T, i48T}}},
--      {{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T, fp16T, fp16T, fp16T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T, fp16T, fp16T, fp16T}}},
--      {{Extension::bf16}, {{bf16T, bf16T, bf16T, fp32T, bf16T}}}}},
--    {"tosa.fft2d", {{{Extension::fft}, {{fp32T, fp32T, fp32T, fp32T}}}}},
--    {"tosa.fully_connected",
--     {{{Extension::int4}, {{i8T, i4T, i32T, i32T}}},
--      {{Extension::int16}, {{i16T, i8T, i48T, i48T}}},
--      {{Extension::bf16}, {{bf16T, bf16T, fp32T, fp32T}}}}},
--    {"tosa.matmul",
--     {{{Extension::int16}, {{i16T, i16T, i48T}}},
--      {{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T, fp16T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T, fp16T}}},
--      {{Extension::bf16}, {{bf16T, bf16T, fp32T}}}}},
--    {"tosa.max_pool2d",
--     {{{Extension::int16}, {{i16T, i16T}}},
--      {{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
--      {{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.rfft2d", {{{Extension::fft}, {{fp32T, fp32T, fp32T}}}}},
--    {"tosa.transpose_conv2d",
--     {{{Extension::int4}, {{i8T, i4T, i32T, i32T, i32T}}},
--      {{Extension::int16}, {{i16T, i8T, i48T, i48T, i48T}}},
--      {{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T, fp16T, fp16T, fp16T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T, fp16T, fp16T, fp16T}}},
--      {{Extension::bf16}, {{bf16T, bf16T, bf16T, fp32T, bf16T}}}}},
--    {"tosa.clamp",
--     {{{Extension::int16}, {{i16T, i16T}}},
--      {{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.erf", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.sigmoid", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.tanh", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.add", {{{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
--    {"tosa.maximum", {{{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
--    {"tosa.minimum", {{{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
--    {"tosa.mul", {{{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
--    {"tosa.pow", {{{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
--    {"tosa.sub", {{{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
--    {"tosa.table", {{{Extension::int16}, {{i16T, i16T, i32T}}}}},
--    {"tosa.abs", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.ceil", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.cos", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.exp", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.floor", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.log", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.negate", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.reciprocal", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.rsqrt", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.select", {{{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
--    {"tosa.sin", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.equal", {{{Extension::bf16}, {{bf16T, bf16T, boolT}}}}},
--    {"tosa.greater", {{{Extension::bf16}, {{bf16T, bf16T, boolT}}}}},
--    {"tosa.greater_equal", {{{Extension::bf16}, {{bf16T, bf16T, boolT}}}}},
--    {"tosa.reduce_max", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.reduce_min", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.reduce_product", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.reduce_sum", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.concat",
--     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
--      {{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.pad",
--     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
--      {{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.reshape",
--     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
--      {{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.reverse",
--     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
--      {{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.slice",
--     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
--      {{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.tile",
--     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
--      {{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.transpose",
--     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
--      {{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.gather",
--     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
--      {{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.scatter",
--     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T, fp8e4m3T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T, fp8e5m2T}}},
--      {{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
--    {"tosa.resize",
--     {{{Extension::int16}, {{i16T, i48T}, {i16T, i16T}}},
--      {{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.cast",
--     {{{Extension::bf16},
--       {{i8T, bf16T},
--        {i16T, bf16T},
--        {i32T, bf16T},
--        {bf16T, i8T},
--        {bf16T, i16T},
--        {bf16T, i32T},
--        {bf16T, fp32T},
--        {fp32T, bf16T}}},
--      {{Extension::bf16, Extension::fp8e4m3},
--       {{bf16T, fp8e4m3T}, {fp8e4m3T, bf16T}}},
--      {{Extension::bf16, Extension::fp8e5m2},
--       {{bf16T, fp8e5m2T}, {fp8e5m2T, bf16T}}},
--      {{Extension::fp8e4m3},
--       {{fp8e4m3T, fp16T},
--        {fp8e4m3T, fp32T},
--        {fp16T, fp8e4m3T},
--        {fp32T, fp8e4m3T}}},
--      {{Extension::fp8e5m2},
--       {{fp8e5m2T, fp16T},
--        {fp8e5m2T, fp32T},
--        {fp16T, fp8e5m2T},
--        {fp32T, fp8e5m2T}}}}},
--    {"tosa.rescale",
--     {{{Extension::int16}, {{i48T, i8T}, {i48T, i16T}, {i48T, i32T}}}}},
--    {"tosa.const",
--     {{{Extension::int4}, {{i4T}}},
--      {{Extension::int16}, {{i48T}}},
--      {{Extension::fp8e4m3}, {{fp8e4m3T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T}}},
--      {{Extension::bf16}, {{bf16T}}}}},
--    {"tosa.identity",
--     {{{Extension::int4}, {{i4T, i4T}}},
--      {{Extension::int16}, {{i48T, i48T}}},
--      {{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
--      {{Extension::bf16}, {{bf16T, bf16T}}}}},
--    {"tosa.dim",
--     {{{Extension::fp8e4m3}, {{fp8e4m3T}}},
--      {{Extension::fp8e5m2}, {{fp8e5m2T}}},
--      {{Extension::bf16}, {{bf16T}}}}},
--};
--// End of auto-generated metadata
-diff -ruN --strip-trailing-cr a/mlir/include/mlir/Dialect/Tosa/IR/TosaComplianceData.h.inc b/mlir/include/mlir/Dialect/Tosa/IR/TosaComplianceData.h.inc
---- a/mlir/include/mlir/Dialect/Tosa/IR/TosaComplianceData.h.inc
-+++ b/mlir/include/mlir/Dialect/Tosa/IR/TosaComplianceData.h.inc
-@@ -0,0 +1,403 @@
-+// The profile-based compliance content below is auto-generated by the script
-+// `tools/genspec.py` in https://git.mlplatform.org/tosa/specification.git
-+profileComplianceMap = {
-+    {"tosa.argmax",
-+     {{{Profile::pro_int}, {{i8T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, i32T}, {fp32T, i32T}}}}},
-+    {"tosa.avg_pool2d",
-+     {{{Profile::pro_int}, {{i8T, i32T, i8T}}},
-+      {{Profile::pro_fp},
-+       {{fp16T, fp16T, fp16T}, {fp16T, fp32T, fp16T}, {fp32T, fp32T, fp32T}}}}},
-+    {"tosa.conv2d",
-+     {{{Profile::pro_int}, {{i8T, i8T, i32T, i32T, i32T}}},
-+      {{Profile::pro_fp},
-+       {{fp16T, fp16T, fp16T, fp16T, fp16T},
-+        {fp16T, fp16T, fp16T, fp32T, fp16T},
-+        {fp32T, fp32T, fp32T, fp32T, fp32T}}}}},
-+    {"tosa.conv3d",
-+     {{{Profile::pro_int}, {{i8T, i8T, i32T, i32T, i32T}}},
-+      {{Profile::pro_fp},
-+       {{fp16T, fp16T, fp16T, fp16T, fp16T},
-+        {fp16T, fp16T, fp16T, fp32T, fp16T},
-+        {fp32T, fp32T, fp32T, fp32T, fp32T}}}}},
-+    {"tosa.depthwise_conv2d",
-+     {{{Profile::pro_int}, {{i8T, i8T, i32T, i32T, i32T}}},
-+      {{Profile::pro_fp},
-+       {{fp16T, fp16T, fp16T, fp16T, fp16T},
-+        {fp16T, fp16T, fp16T, fp32T, fp16T},
-+        {fp32T, fp32T, fp32T, fp32T, fp32T}}}}},
-+    {"tosa.fully_connected",
-+     {{{Profile::pro_int}, {{i8T, i8T, i32T, i32T}}},
-+      {{Profile::pro_fp},
-+       {{fp16T, fp16T, fp16T, fp16T},
-+        {fp16T, fp16T, fp32T, fp32T},
-+        {fp32T, fp32T, fp32T, fp32T}}}}},
-+    {"tosa.matmul",
-+     {{{Profile::pro_int}, {{i8T, i8T, i32T}}},
-+      {{Profile::pro_fp},
-+       {{fp16T, fp16T, fp16T}, {fp16T, fp16T, fp32T}, {fp32T, fp32T, fp32T}}}}},
-+    {"tosa.max_pool2d",
-+     {{{Profile::pro_int}, {{i8T, i8T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.transpose_conv2d",
-+     {{{Profile::pro_int}, {{i8T, i8T, i32T, i32T, i32T}}},
-+      {{Profile::pro_fp},
-+       {{fp16T, fp16T, fp16T, fp16T, fp16T},
-+        {fp16T, fp16T, fp16T, fp32T, fp16T},
-+        {fp32T, fp32T, fp32T, fp32T, fp32T}}}}},
-+    {"tosa.clamp",
-+     {{{Profile::pro_int}, {{i8T, i8T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.erf", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.sigmoid", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.tanh", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.add",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{i32T, i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
-+    {"tosa.arithmetic_right_shift",
-+     {{{Profile::pro_int},
-+       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}}}},
-+    {"tosa.bitwise_and",
-+     {{{Profile::pro_int},
-+       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}}}},
-+    {"tosa.bitwise_or",
-+     {{{Profile::pro_int},
-+       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}}}},
-+    {"tosa.bitwise_xor",
-+     {{{Profile::pro_int},
-+       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}}}},
-+    {"tosa.intdiv",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{i32T, i32T, i32T}}}}},
-+    {"tosa.logical_and",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT, boolT}}}}},
-+    {"tosa.logical_left_shift",
-+     {{{Profile::pro_int, Profile::pro_fp},
-+       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}}}},
-+    {"tosa.logical_right_shift",
-+     {{{Profile::pro_int, Profile::pro_fp},
-+       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}}}},
-+    {"tosa.logical_or",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT, boolT}}}}},
-+    {"tosa.logical_xor",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT, boolT}}}}},
-+    {"tosa.maximum",
-+     {{{Profile::pro_int}, {{i32T, i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
-+    {"tosa.minimum",
-+     {{{Profile::pro_int}, {{i32T, i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
-+    {"tosa.mul",
-+     {{{Profile::pro_int}, {{i8T, i8T, i32T}, {i16T, i16T, i32T}}},
-+      {{Profile::pro_int, Profile::pro_fp}, {{i32T, i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
-+    {"tosa.pow",
-+     {{{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
-+    {"tosa.sub",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{i32T, i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
-+    {"tosa.table", {{{Profile::pro_int}, {{i8T, i8T, i8T}}}}},
-+    {"tosa.abs",
-+     {{{Profile::pro_int}, {{i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.bitwise_not",
-+     {{{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}}}},
-+    {"tosa.ceil", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.clz", {{{Profile::pro_int}, {{i32T, i32T}}}}},
-+    {"tosa.cos", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.exp", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.floor", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.log", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.logical_not",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}}}},
-+    {"tosa.negate",
-+     {{{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.reciprocal",
-+     {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.rsqrt", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.select",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT, boolT}}},
-+      {{Profile::pro_int},
-+       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
-+    {"tosa.sin", {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.equal",
-+     {{{Profile::pro_int}, {{i32T, i32T, boolT}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T, boolT}, {fp32T, fp32T, boolT}}}}},
-+    {"tosa.greater",
-+     {{{Profile::pro_int}, {{i32T, i32T, boolT}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T, boolT}, {fp32T, fp32T, boolT}}}}},
-+    {"tosa.greater_equal",
-+     {{{Profile::pro_int}, {{i32T, i32T, boolT}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T, boolT}, {fp32T, fp32T, boolT}}}}},
-+    {"tosa.reduce_all",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}}}},
-+    {"tosa.reduce_any",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}}}},
-+    {"tosa.reduce_max",
-+     {{{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.reduce_min",
-+     {{{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.reduce_product",
-+     {{{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.reduce_sum",
-+     {{{Profile::pro_int}, {{i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.concat",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}},
-+      {{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.pad",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}},
-+      {{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.reshape",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}},
-+      {{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.reverse",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}},
-+      {{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.slice",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}},
-+      {{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.tile",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}},
-+      {{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.transpose",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT, boolT}}},
-+      {{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.gather",
-+     {{{Profile::pro_int}, {{i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.scatter",
-+     {{{Profile::pro_int},
-+       {{i8T, i8T, i8T}, {i16T, i16T, i16T}, {i32T, i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T, fp16T}, {fp32T, fp32T, fp32T}}}}},
-+    {"tosa.resize",
-+     {{{Profile::pro_int}, {{i8T, i32T}, {i8T, i8T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.cast",
-+     {{{Profile::pro_int},
-+       {{boolT, i8T},
-+        {boolT, i16T},
-+        {boolT, i32T},
-+        {i8T, boolT},
-+        {i8T, i16T},
-+        {i8T, i32T},
-+        {i16T, boolT},
-+        {i16T, i8T},
-+        {i16T, i32T},
-+        {i32T, boolT},
-+        {i32T, i8T},
-+        {i32T, i16T}}},
-+      {{Profile::pro_fp},
-+       {{i8T, fp16T},
-+        {i8T, fp32T},
-+        {i16T, fp16T},
-+        {i16T, fp32T},
-+        {i32T, fp16T},
-+        {i32T, fp32T},
-+        {fp16T, i8T},
-+        {fp16T, i16T},
-+        {fp16T, i32T},
-+        {fp16T, fp32T},
-+        {fp32T, i8T},
-+        {fp32T, i16T},
-+        {fp32T, i32T},
-+        {fp32T, fp16T}}}}},
-+    {"tosa.rescale",
-+     {{{Profile::pro_int},
-+       {{i8T, i8T},
-+        {i8T, i16T},
-+        {i8T, i32T},
-+        {i16T, i8T},
-+        {i16T, i16T},
-+        {i16T, i32T},
-+        {i32T, i8T},
-+        {i32T, i16T},
-+        {i32T, i32T}}}}},
-+    {"tosa.const",
-+     {{{Profile::pro_int}, {{boolT}, {i8T}, {i16T}, {i32T}}},
-+      {{Profile::pro_fp}, {{fp16T}, {fp32T}}}}},
-+    {"tosa.identity",
-+     {{{Profile::pro_int},
-+       {{boolT, boolT}, {i8T, i8T}, {i16T, i16T}, {i32T, i32T}}},
-+      {{Profile::pro_fp}, {{fp16T, fp16T}, {fp32T, fp32T}}}}},
-+    {"tosa.dim",
-+     {{{Profile::pro_int, Profile::pro_fp}, {{boolT}}},
-+      {{Profile::pro_int}, {{i8T}, {i16T}, {i32T}}},
-+      {{Profile::pro_fp}, {{fp16T}, {fp32T}}}}},
-+};
-+
-+extensionComplianceMap = {
-+    {"tosa.argmax",
-+     {{{Extension::int16}, {{i16T, i32T}}},
-+      {{Extension::fp8e4m3}, {{fp8e4m3T, i32T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, i32T}}},
-+      {{Extension::bf16}, {{bf16T, i32T}}}}},
-+    {"tosa.avg_pool2d",
-+     {{{Extension::int16}, {{i16T, i32T, i16T}}},
-+      {{Extension::fp8e4m3}, {{fp8e4m3T, fp16T, fp8e4m3T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp16T, fp8e5m2T}}},
-+      {{Extension::bf16}, {{bf16T, fp32T, bf16T}}}}},
-+    {"tosa.conv2d",
-+     {{{Extension::int4}, {{i8T, i4T, i32T, i32T, i32T}}},
-+      {{Extension::int16}, {{i16T, i8T, i48T, i48T, i48T}}},
-+      {{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T, fp16T, fp16T, fp16T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T, fp16T, fp16T, fp16T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T, bf16T, fp32T, bf16T}}}}},
-+    {"tosa.conv3d",
-+     {{{Extension::int4}, {{i8T, i4T, i32T, i32T, i32T}}},
-+      {{Extension::int16}, {{i16T, i8T, i48T, i48T, i48T}}},
-+      {{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T, fp16T, fp16T, fp16T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T, fp16T, fp16T, fp16T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T, bf16T, fp32T, bf16T}}}}},
-+    {"tosa.depthwise_conv2d",
-+     {{{Extension::int4}, {{i8T, i4T, i32T, i32T, i32T}}},
-+      {{Extension::int16}, {{i16T, i8T, i48T, i48T, i48T}}},
-+      {{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T, fp16T, fp16T, fp16T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T, fp16T, fp16T, fp16T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T, bf16T, fp32T, bf16T}}}}},
-+    {"tosa.fft2d", {{{Extension::fft}, {{fp32T, fp32T, fp32T, fp32T}}}}},
-+    {"tosa.fully_connected",
-+     {{{Extension::int4}, {{i8T, i4T, i32T, i32T}}},
-+      {{Extension::int16}, {{i16T, i8T, i48T, i48T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T, fp32T, fp32T}}}}},
-+    {"tosa.matmul",
-+     {{{Extension::int16}, {{i16T, i16T, i48T}}},
-+      {{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T, fp16T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T, fp16T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T, fp32T}}}}},
-+    {"tosa.max_pool2d",
-+     {{{Extension::int16}, {{i16T, i16T}}},
-+      {{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.rfft2d", {{{Extension::fft}, {{fp32T, fp32T, fp32T}}}}},
-+    {"tosa.transpose_conv2d",
-+     {{{Extension::int4}, {{i8T, i4T, i32T, i32T, i32T}}},
-+      {{Extension::int16}, {{i16T, i8T, i48T, i48T, i48T}}},
-+      {{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T, fp16T, fp16T, fp16T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T, fp16T, fp16T, fp16T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T, bf16T, fp32T, bf16T}}}}},
-+    {"tosa.clamp",
-+     {{{Extension::int16}, {{i16T, i16T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.erf", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.sigmoid", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.tanh", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.add", {{{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
-+    {"tosa.maximum", {{{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
-+    {"tosa.minimum", {{{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
-+    {"tosa.mul", {{{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
-+    {"tosa.pow", {{{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
-+    {"tosa.sub", {{{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
-+    {"tosa.table", {{{Extension::int16}, {{i16T, i16T, i32T}}}}},
-+    {"tosa.abs", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.ceil", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.cos", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.exp", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.floor", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.log", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.negate", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.reciprocal", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.rsqrt", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.select", {{{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
-+    {"tosa.sin", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.equal", {{{Extension::bf16}, {{bf16T, bf16T, boolT}}}}},
-+    {"tosa.greater", {{{Extension::bf16}, {{bf16T, bf16T, boolT}}}}},
-+    {"tosa.greater_equal", {{{Extension::bf16}, {{bf16T, bf16T, boolT}}}}},
-+    {"tosa.reduce_max", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.reduce_min", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.reduce_product", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.reduce_sum", {{{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.concat",
-+     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.pad",
-+     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.reshape",
-+     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.reverse",
-+     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.slice",
-+     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.tile",
-+     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.transpose",
-+     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.gather",
-+     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.scatter",
-+     {{{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T, fp8e4m3T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T, fp8e5m2T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T, bf16T}}}}},
-+    {"tosa.resize",
-+     {{{Extension::int16}, {{i16T, i48T}, {i16T, i16T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.cast",
-+     {{{Extension::bf16},
-+       {{i8T, bf16T},
-+        {i16T, bf16T},
-+        {i32T, bf16T},
-+        {bf16T, i8T},
-+        {bf16T, i16T},
-+        {bf16T, i32T},
-+        {bf16T, fp32T},
-+        {fp32T, bf16T}}},
-+      {{Extension::bf16, Extension::fp8e4m3},
-+       {{bf16T, fp8e4m3T}, {fp8e4m3T, bf16T}}},
-+      {{Extension::bf16, Extension::fp8e5m2},
-+       {{bf16T, fp8e5m2T}, {fp8e5m2T, bf16T}}},
-+      {{Extension::fp8e4m3},
-+       {{fp8e4m3T, fp16T},
-+        {fp8e4m3T, fp32T},
-+        {fp16T, fp8e4m3T},
-+        {fp32T, fp8e4m3T}}},
-+      {{Extension::fp8e5m2},
-+       {{fp8e5m2T, fp16T},
-+        {fp8e5m2T, fp32T},
-+        {fp16T, fp8e5m2T},
-+        {fp32T, fp8e5m2T}}}}},
-+    {"tosa.rescale",
-+     {{{Extension::int16}, {{i48T, i8T}, {i48T, i16T}, {i48T, i32T}}}}},
-+    {"tosa.const",
-+     {{{Extension::int4}, {{i4T}}},
-+      {{Extension::int16}, {{i48T}}},
-+      {{Extension::fp8e4m3}, {{fp8e4m3T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T}}},
-+      {{Extension::bf16}, {{bf16T}}}}},
-+    {"tosa.identity",
-+     {{{Extension::int4}, {{i4T, i4T}}},
-+      {{Extension::int16}, {{i48T, i48T}}},
-+      {{Extension::fp8e4m3}, {{fp8e4m3T, fp8e4m3T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T, fp8e5m2T}}},
-+      {{Extension::bf16}, {{bf16T, bf16T}}}}},
-+    {"tosa.dim",
-+     {{{Extension::fp8e4m3}, {{fp8e4m3T}}},
-+      {{Extension::fp8e5m2}, {{fp8e5m2T}}},
-+      {{Extension::bf16}, {{bf16T}}}}},
-+};
-+// End of auto-generated metadata
-diff -ruN --strip-trailing-cr a/mlir/lib/Dialect/Tosa/Transforms/TosaProfileCompliance.cpp b/mlir/lib/Dialect/Tosa/Transforms/TosaProfileCompliance.cpp
---- a/mlir/lib/Dialect/Tosa/Transforms/TosaProfileCompliance.cpp
-+++ b/mlir/lib/Dialect/Tosa/Transforms/TosaProfileCompliance.cpp
-@@ -27,7 +27,7 @@
- 
- // The profile-based compliance content below is auto-generated by a script
- // in https://git.mlplatform.org/tosa/specification.git
--#include "mlir/Dialect/Tosa/IR/TosaComplianceData.h"
-+#include "mlir/Dialect/Tosa/IR/TosaComplianceData.h.inc"
-   // End of auto-generated metadata
- }
- 
-diff -ruN --strip-trailing-cr a/utils/bazel/llvm-project-overlay/mlir/BUILD.bazel b/utils/bazel/llvm-project-overlay/mlir/BUILD.bazel
---- a/utils/bazel/llvm-project-overlay/mlir/BUILD.bazel
-+++ b/utils/bazel/llvm-project-overlay/mlir/BUILD.bazel
-@@ -12356,7 +12356,9 @@
-         "lib/Dialect/Tosa/IR/*.cpp",
-         "lib/Dialect/Tosa/Utils/*.cpp",
-         "lib/Dialect/Tosa/Transforms/*.cpp",
--    ]),
-+    ]) + [
-+        "include/mlir/Dialect/Tosa/IR/TosaComplianceData.h.inc",
-+    ],
-     hdrs = glob([
-         "include/mlir/Dialect/Tosa/IR/*.h",
-         "include/mlir/Dialect/Tosa/Utils/*.h",
diff --git a/third_party/llvm/workspace.bzl b/third_party/llvm/workspace.bzl
index d1548b5..cd6376f 100644
--- a/third_party/llvm/workspace.bzl
+++ b/third_party/llvm/workspace.bzl
@@ -4,8 +4,8 @@ load("//third_party:repo.bzl", "tf_http_archive")
 
 def repo(name):
     """Imports LLVM."""
-    LLVM_COMMIT = "43d71baae36c8d8b5a9995aa35efebe09cc9c2d6"
-    LLVM_SHA256 = "436af8b4c3403e251ab0b7a471eda7df6063f9da9d22ccbe498f3115cd35225a"
+    LLVM_COMMIT = "cf50936b23ac25c786d66be6d7b9277398cddde5"
+    LLVM_SHA256 = "f5d3bab6a8a1ed1c7b5da74f916201a44381489755f7c708f12f7e6516c21c87"
 
     tf_http_archive(
         name = name,
